<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:cc="http://java.sun.com/jsf/composite">
	<cc:interface componentType="imageEditorComponent">
		<cc:attribute name="defaultImageUrl" type="java.lang.String"
			shortDescription="Default image URL to show when there is not image setted" />
		<cc:attribute name="imageUrl"
			type="com.hallocasa.commons.vo.ImageContainer" required="true"
			shortDescription="Image URL to edit" />
		<cc:attribute name="imageType" type="java.lang.String" default="image"
			shortDescription="Image type as scheme to manage image files" />
		<cc:attribute name="readOnly" type="java.lang.Boolean" default="false"
			shortDescription="Indicates image only must be showed, but not edited" />
	</cc:interface>
	<cc:implementation>
		<h:panelGroup id="image-editor-container">

			<div class="edit-btn-content col-md-12">
				<h:commandButton styleClass="btn btn-primary"
					rendered="#{not cc.attrs.readOnly}"
					value="#{viewBundle['Image.Edition']}"
					onclick="PF('upload-image-dialog').show();return false" />
			</div>
			<div class="hc-responsive-div col-md-12">
				<h:graphicImage url="#{cc.attrs.imageUrl.url}" />
			</div>


			<p:dialog header="#{viewBundle['Image.Edition.Header']}"
				position="center" widgetVar="upload-image-dialog" minHeight="40"
				width="800" height="500" draggable="false" resizable="false">
				<h:panelGroup id="upload-image-bt" styleClass="row">
				</h:panelGroup>
				<h:panelGroup id="upload-image-pg" styleClass="row hc-content-edit-info">
					<h:panelGroup rendered="#{cc.showImageLoad}">
						<h:outputText value="#{viewBundle['Image.Edition.Header.Detail']}" />
						<h:inputFile id="file" value="#{cc.uncroppedImagePart}"
							styleClass="" validator="#{cc.validateFile}">
						</h:inputFile>
						<h:commandButton
							value="#{viewBundle['Image.Edition.Header.Upload']}"
							action="#{cc.onFileUpload}" styleClass="btn btn-default">
							<f:ajax execute="file" render="upload-image-pg upload-image-bt" />
						</h:commandButton>
					</h:panelGroup>
					<h:panelGroup rendered="#{cc.showImageCrop}">
						<h:outputText value="#{viewBundle['Image.Edition.Crop']}" />
						<h:panelGrid columns="2">
							<div class="row">
							<div class="col-md-6">
								<h:commandButton
									value="#{viewBundle['Image.Edition.FinishCrop']}"
									action="#{cc.onImageCrop}" style="float:left"
									styleClass="btn btn-default hc-edit-finish-img">
									<f:ajax execute="cropper" render="image-editor-container" />
								</h:commandButton>
							</div>
							<div class="col-md-6">
								<h:commandButton value="#{viewBundle['Common.Label.Back']}"
									action="#{cc.onBackClick}" rendered="#{cc.showBackButton}"
									styleClass="btn btn-default">
									<f:ajax render="upload-image-pg upload-image-bt" />
								</h:commandButton>
								<h:commandButton value="#{viewBundle['Common.Label.Next']}"
									action="#{cc.onNextClick}" rendered="#{cc.showNextButton}"
									styleClass="btn btn-default">
									<f:ajax render="upload-image-pg upload-image-bt" />
								</h:commandButton>
							</div>
							</div>
							<p:imageCropper id="cropper" value="#{cc.croppedImage}"
								image="/resources/images/#{cc.uncroppedImageResourcesUrl}"
								initialCoords="0,0,50,50" />
						</h:panelGrid>
					</h:panelGroup>
				</h:panelGroup>
			</p:dialog>
		</h:panelGroup>
	</cc:implementation>
</ui:composition>