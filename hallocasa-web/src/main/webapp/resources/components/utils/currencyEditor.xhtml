<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:cc="http://java.sun.com/jsf/composite">
	<cc:interface componentType="currencyEditorComponent">
		<cc:attribute name="value"
			type="com.hallocasa.commons.vo.CurrencyVOAmmount"
			shortDescription="Currency vo ammount value" />
		<cc:attribute name="currencies" type="java.util.List"
			shortDescription="Currency list to deploy" />
		<cc:attribute name="converter" type="java.lang.String"
			shortDescription="Converter to use" />
		<cc:attribute name="language" type="com.hallocasa.commons.Language"
			shortDescription="Language to manage" />
		<cc:attribute name="label" type="java.lang.String"
			shortDescription="Label to show in validation error messages" />
		<cc:attribute name="validatorMessage" type="java.lang.String"
			shortDescription="Message to show when currency ammount is not number" />
		<cc:attribute name="defaultMessage" type="java.lang.String"
			shortDescription="Default message when no currency selected" />
	</cc:interface>
	<cc:implementation>
		<p>
		<script>
			function format(input) {
				var inputVal = parseInt(input.value.replace(/\./g, ''));
			    var numericVal = (isNaN(inputVal) ? "" : inputVal).toString();
			    var cnt = 0;
			    for(var i = numericVal.length - 1; i >= 0 ; i--){
			      cnt++;
			      if(cnt%3 == 0 &amp;&amp; i > 0)
			        numericVal = numericVal.substring(0, i)+ "." + numericVal.substring(i);
			    }
			    input.value = numericVal;
			}
		</script>
			<h:inputText id="currencyValue"
				styleClass="hc-form-field form-control currency"
				binding="#{cc.currencyAmmount}"
				label="#{cc.attrs.label}"
				required="true" onkeyup="format(this)"
				converter="javax.faces.Double">
				<f:convertNumber groupingUsed="false" locale="es_PE" />
			</h:inputText>
		</p>
		<h:outputScript>
			$("input[type='text'].currency").each(function(i){
				var obj = $("input[type='text'].currency:eq(" + i + ")");
				if(obj.val() != null)
					format(obj[0]);
			});
		</h:outputScript>
		<br></br>
		<p style="position: absolute;">
			<h:selectOneMenu id="currency"
				styleClass="hc-form-field form-control hc-select-property-basic-info"
				binding="#{cc.currency}"
				converter="currencyConverter">
				<f:selectItem itemLabel="#{cc.attrs.defaultMessage}" value="#{null}"/>
				<f:selectItems value="#{cc.attrs.currencies}" var="currency"
					itemLabel="#{cc.currencyValue(currency)}" itemValue="#{currency}" />
			</h:selectOneMenu>
		</p>
	</cc:implementation>
</ui:composition>