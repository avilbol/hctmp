<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:utils="http://java.sun.com/jsf/composite/components/utils">


		<script type="text/javascript">
			jQuery(document).ready(function() {
				$("strong[id^='title-content-id']").each(function(i){
					var obj = $("[id^='title-content-id']:eq(" + i + ")");
					var propertyContent = obj[0];
					var title =  propertyContent.textContent;
					var titleClear = jQuery.trim(title);
					var comp = titleClear.length > 60 ? "..." : "";
					var shortText = titleClear.substring(0, 60)
				      .split(" ").slice().join(" ") + comp;
					propertyContent.textContent = shortText;
				});

				$("div[id^='description-content-id']").each(function(i){
					var obj = $("[id^='description-content-id']:eq(" + i + ")");
					var propertyContent = obj[0];
					var title =  propertyContent.textContent;
					var titleClear = jQuery.trim(title);
					var comp = titleClear.length > 160 ? "..." : "";
					var shortText = titleClear.substring(0, 160)
				      .split(" ").slice().join(" ") + comp;
					propertyContent.textContent = shortText;
				});
			});
		</script>

	<div class="hc-content-body-properties">
		<div class="row hc-contents-cards">
			<h:form styleClass="hc-form" enctype="multipart/form-data">
				<p:messages id="messages" showDetail="false" autoUpdate="true"
					closable="true" />
				<div class="col-md-10"></div>
				<div class="col-md-2 btn-responsive">
					<h:commandButton value="#{viewBundle['Properties.create.label']}"
						action="#{globalProfilePage.goToCreateProperty()}"
						disabled="#{propertyListPage.inhabilitedUser}"
						styleClass="btn btn-primary btn-responsive col-md-12" immediate="true">
						<f:ajax execute="@this"
							render=":hc-profile-form:container-property-element" />
					</h:commandButton>
				</div>
				<div class="col-md-9">
				    <ui:fragment rendered="#{propertyListPage.inhabilitedUser}">
						<div class="row" style="text-align: center;">
							<span class="hc-form-label hc-without-properties alert-info">
								#{viewBundle['Properties.warning.usertypes']} </span>
						</div>
					</ui:fragment>
					<ui:fragment rendered="#{propertyListPage.propertyList.isEmpty()}">
						<div class="row" style="text-align: center;">
							<span class="hc-form-label hc-without-properties alert-info">
								#{viewBundle['Properties.none.property']} </span>
						</div>
					</ui:fragment>
					<ui:repeat var="property" value="#{propertyListPage.propertyList}">
						<div class="row hc-contents-cards-list">
							<div class="col-md-12 hc-cards-list">
								<div class="col-md-3 hc-content-card-image">
									<div class="col-md-12 hc-responsive-div-properties">
										<h:graphicImage
											url="#{property.propertyImageInfo.mainImage.url}"
											rendered="#{property.propertyImageInfo.mainImage != null}"
											styleClass="img-responsive" />
										<h:graphicImage url="#{propertyPresentationPage.defaultImageUrl}"
											rendered="#{property.propertyImageInfo.mainImage == null}"
											styleClass="img-responsive" />
									</div>
									<div class="col-md-12 hc-cards-city">
										<label class="control-form hc-properties-city">
											#{propertyPresentationPage.getCityName(property.propertyLocationInfo.city.id)}
										</label>
									</div>
								</div>
								<div class="col-md-9 hc-cards-propertie-title">
									<strong id="title-content-id-#{property.id}">#{propertyPresentationPage.titleValue(property)}</strong>
								</div>
								<div class="col-md-3">
									<div class="col-md-12">
										<div class="col-md-12">
											<label class="col-md-6 hc-properties-features">
												#{propertyPresentationPage.langValue(property.propertyType.name)} </label> 
											<ui:remove>
											<label class="col-md-6 hc-properties-features">
												#{propertyPresentationPage.langValue(property.propertyProposal.name)}
											</label>
											</ui:remove>
										</div>

										<div class="col-md-12">
											<label class="col-md-12 hc-properties-features"
												style="font-weight: 600;">
												#{propertyPresentationPage.currencyValue(property.propertyBasicInfo.marketPrice)}
											</label> <label class="col-md-12 hc-properties-features">
												#{propertyPresentationPage.squareMetersValue(property.propertyBasicInfo.area)}
											</label>
										</div>
									</div>
								</div>
								<div class="col-md-6 hc-cards-list" id="description-content-id-#{property.id}">
									#{propertyPresentationPage.propertyDescriptionValue(property)}</div>
							</div>
							<div class="col-md-12">
								<div class="col-md-8"></div>
								<div class="col-md-4">
									<p:commandButton value="#{viewBundle['Properties.edit.label']}"
										styleClass="btn btn-primary" rendered="#{not viewMode}"
										action="#{globalProfilePage.goToEditProperty(property)}">
										<f:ajax execute="@this"
											render=":hc-profile-form:container-property-element" />
									</p:commandButton>

									<button type="button" class="btn btn-delete"
										data-toggle="modal" data-target="#myModal-#{property.id}">
										<span class="hc-form-label">#{viewBundle['Properties.delete.label']}</span>
									</button>
								</div>
							</div>
						</div>
						<!-- Modal -->
						<div class="modal fade" id="myModal-#{property.id}" role="dialog">
							<div class="modal-dialog">
								<!-- Modal content-->
								<div class="modal-content">
									<div class="modal-header">
										<h4 class="modal-title">
											<span class="hc-form-label">#{viewBundle['Properties.title.modal']}</span>
										</h4>
									</div>
									<div class="modal-body">
										<p>
											<span class="hc-form-label">#{viewBundle['Properties.content.modal']}</span>
										</p>
									</div>
									<div class="modal-footer">
										<p:commandButton id="delete-button-#{property.id}"
											data-dismiss="modal"
											value="#{viewBundle['Properties.delete.label']}"
											styleClass="btn btn-primary"
											style="margin-top: 18px!important; margin-bottom: 0!important;font-size: large;padding: 2px;"
											action="#{propertyListPage.onDeletePropertyClick(property)}"
											onclick="$('#myModal').modal('hide'); return true; ">
											<f:ajax execute="@this"
												render="@form" />
										</p:commandButton>
										<button type="button" class="btn btn-primary btn-lg"
											data-dismiss="modal">
											<span class="hc-form-label">#{viewBundle['Properties.cancel.label']}</span>
										</button>
									</div>
								</div>
							</div>
						</div>
					</ui:repeat>
				</div>
			</h:form>
		</div>
	</div>
</ui:composition>