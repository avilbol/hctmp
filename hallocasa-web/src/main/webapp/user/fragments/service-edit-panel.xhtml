<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:utils="http://java.sun.com/jsf/composite/components/utils">
    <p:panel header="#{viewBundle['Profile.Service.Panel.Title']}" >
        <div class="section hc-overlay-form-fields-container clearfix">
            <p:fieldset styleClass="col span_3_of_3" 
                        legend="#{viewBundle['Profile.Data.Services.Label']}" 
                        toggleable="true" 
                        toggleSpeed="500"> 
                <p:selectManyCheckbox
                    id="userTypes" 
                    label="Servicios"
                    value="#{profileEditPage.user.userTypes}"
                    styleClass="hc-selectManyChkbox"
                    converter="userTypeConverter">
                    <f:selectItems 
                        value="#{applicationContext.userTypes}" 
                        var="userType" 
                        itemLabel="#{userType.userTypeName.getText(webSession.currentLanguage)}" 
                        itemValue="#{userType}">
                    </f:selectItems>
                    <p:ajax 
                        event="change" 
                        update="advanced-services-area" />
                </p:selectManyCheckbox>
            </p:fieldset>
        </div>

        <h:panelGroup 
            id="advanced-services-area">
            <h:panelGroup 
                rendered="#{not empty profileEditPage.user.userTypes}">
                <div class="section hc-overlay-form-fields-container clearfix">            
                    <div class="col span_1_of_3">
                        <span id="imageUrl">
                            <utils:imageEditor 
                                imageUrl="#{profileEditPage.user.image}"
                                imageType="userImage"/>
                        </span>
                        <b><p:outputLabel 
                            styleClass="hc-form-label"
                            value="#{viewBundle['Profile.Data.Country.Label']}" 
                            for="countryName" /></b>
                        <h:selectOneMenu
                            id="countryName" 
                            styleClass="hc-form-field"
                            value="#{profileEditPage.user.country}"
                            converter="countryConverter">
                            <f:selectItem itemLabel="Select a Country" />
                            <f:selectItems 
                                value="#{applicationContext.countries}"
                                var="country"
                                itemLabel="#{profileEditPage.getCountryName(country)}"
                                itemValue="#{country}"/>
                            <p:ajax 
                                event="change" 
                                listener="#{profileEditPage.processCountrySelect}"
                                process="@this"
                                update="stateName,cityName">
                            </p:ajax>
                        </h:selectOneMenu>
                        <br/>

                        <b><p:outputLabel 
                            styleClass="hc-form-label"
                            value="#{viewBundle['Profile.Data.State.Label']}" 
                            for="stateName"/></b>
                        <h:selectOneMenu 
                            id="stateName" 
                            styleClass="hc-form-field"
                            value="#{profileEditPage.user.state}"
                            converter="stateConverter">
                            <f:selectItems 
                                value="#{profileEditPage.states}"
                                var="state"
                                itemLabel="#{profileEditPage.getStateName(state)}"
                                itemValue="#{state}"/>
                            <p:ajax 
                                event="change" 
                                listener="#{profileEditPage.processStateSelect}"
                                process="@this"
                                update="cityName">
                            </p:ajax>
                        </h:selectOneMenu>
                        <br/>

                        <b><p:outputLabel 
                            styleClass="hc-form-label"
                            value="#{viewBundle['Profile.Data.City.Label']}" 
                            for="cityName" /></b>
                        <h:selectOneMenu 
                            id="cityName" 
                            styleClass="hc-form-field"
                            value="#{profileEditPage.user.city}"
                            converter="cityConverter">
                            <f:selectItems 
                                value="#{profileEditPage.cities}"
                                var="city"
                                itemLabel="#{profileEditPage.getCityName(city)}"
                                itemValue="#{city}"/>
                        </h:selectOneMenu>
                        <br/>

                        <b><p:outputLabel 
                            styleClass="hc-form-label"
                            value="#{viewBundle['Profile.Data.Website.Label']}" 
                            for="websiteName" /></b>
                        <h:inputText 
                            id="websiteName" styleClass="hc-form-field"
                            value="#{profileEditPage.user.webSite}" />
                        <br/>

                        <b><p:outputLabel 
                            styleClass="hc-form-label"
                            value="#{viewBundle['Profile.Data.Linkedin.Label']}" 
                            for="lkdinName" /></b>
                        <h:inputText 
                            id="lkdinName" styleClass="hc-form-field"
                            value="#{profileEditPage.user.linkedIn}" />
                        <br/>

                        <b><p:outputLabel 
                            styleClass="hc-form-label"
                            value="#{viewBundle['Profile.Data.Skype.Label']}" 
                            for="skypeName" /></b>
                        <h:inputText 
                            id="skypeName" styleClass="hc-form-field"
                            value="#{profileEditPage.user.skype}" />
                    </div>
                    <div class="col span_2_of_3">
                        <p:fieldset legend="#{viewBundle['Profile.Data.Languages.Label']}" 
                                    toggleable="true" 
                                    toggleSpeed="500">
                            <h:panelGroup layout="block" styleClass="hc-manycheckbox-three-columns hc-selectManyChkbox">
                                <p:selectManyCheckbox
                                    id="spokenLanguages"  label="Lenguajes"
                                    value="#{profileEditPage.user.spokenLanguages}"
                                    layout="pageDirection" required="true"
                                    converter="languageConverter"
                                    >
                                    <f:selectItems 
                                        value="#{profileEditPage.languages}" 
                                        var="language" 
                                        itemLabel="#{language.languageName}" 
                                        itemValue="#{language}">
                                    </f:selectItems>
                                    <f:ajax 
                                        listener="#{profileEditPage.processLanguagesSelectedChange}"
                                        render="user-description-section  main-language-section" 
                                        immediate="true"  />
                                </p:selectManyCheckbox>
                            </h:panelGroup>
                        </p:fieldset>
                    </div>
                </div>
                <hr/>
                <h:panelGroup layout="block"
                    styleClass="section hc-overlay-form-fields-container clearfix"
                    id="main-language-section">
                    <b>
                        <h:outputLabel styleClass="hc-form-label" 
                                       for="#{mainSpokenLanguage}" 
                                       value="#{viewBundle['Profile.Data.Languages.MainLanguage.Label']}">
                        </h:outputLabel>
                    </b>
                    <span>
                        <h:selectOneMenu 
                            id="mainSpokenLanguage" 
                            styleClass="hc-form-field"
                            value="#{profileEditPage.user.mainSpokenLanguage}"
                            converter="languageConverter">
                            <f:selectItems 
                                value="#{profileEditPage.user.spokenLanguages}"
                                var="language"
                                itemLabel="#{language.languageName}"
                                itemValue="#{language}"/>
                        </h:selectOneMenu>
                    </span>
                </h:panelGroup>
                <h:panelGroup 
                    layout="block"
                    styleClass="section hc-overlay-form-fields-container clearfix"
                    id="user-description-section">
                    <c:forEach items="#{profileEditPage.user.spokenLanguages}" var="lang">
                        <b>
                            <h:outputLabel styleClass="hc-form-label" for="#{lang}" 
                                           value="#{viewBundle['Profile.Data.Description.Label']} ( #{lang.languageName} )">
                            </h:outputLabel>
                        </b>
                        <span>
                            <p:inputTextarea 
                                rows="10" 
                                id="#{lang}"
                                cols="30" 
                                label="#{viewBundle['Profile.Data.Description.Label']} ( #{lang.languageName} )"
                                value="#{profileEditPage.user.userDescription.langMap[lang]}"
                                maxlength="800" 
                                styleClass="hc-input-text-area"
                                counterTemplate="{0} characters remaining." 
                                autoResize="false" >
                                <f:validateLength minimum="20"/>
                            </p:inputTextarea>
                        </span>
                    </c:forEach>
                </h:panelGroup>
            </h:panelGroup>
        </h:panelGroup>
    </p:panel>
</ui:composition>
